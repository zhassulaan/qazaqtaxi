import{t as He,r as I,p as le,I as ae,v as at,n as lt,h as oe,x as Ie,y as Ce,c as D,d as ot,z as nt,A as st,B as F,j as t,s as q,C as Ke,D as N,E as it,F as se,i as rt,G as Me,S as ze,H as ut,J as dt,K as Z,_ as ie,L as $e,l as B,m as ee,w as m,M as u,N as k,O as ct,o as Ve,P as Y,Q as j,R as H,T as V,U as xe,V as De,W as Ye,X as qe,Y as Q,Z as vt,u as ft,$ as mt,a0 as pt,a1 as _t,a2 as gt,a3 as we,a4 as Ge,a5 as yt,a6 as ht,a7 as bt,k as kt,a8 as wt}from"./index-47b4a022.js";import{u as ve,a as Ae}from"./order-65aed67f.js";import{u as fe}from"./userPanel-b5620d02.js";import{u as Re}from"./directions-c57ca3d8.js";import{U as z}from"./user-7a776cf7.js";import{V as Te,_ as Oe,H as St}from"./HeaderRouter-2e3b5674.js";import{V as re,a as It,C as Ct,b as $t}from"./ClientPanel-f526dfda.js";import{m as Vt,R as xt,V as K,a as We,u as Dt,b as At,c as Rt,d as Ne,e as Se,f as O,g as M,h as U,i as Tt,j as Ot,k as Ue,l as Bt,n as Pt}from"./VRow-06a8dd11.js";import{m as Be,u as ue}from"./useRender-5142e326.js";import{u as Et}from"./search-63670d42.js";import{m as Mt,u as Fe}from"./tag-35f47c51.js";const zt=He("orderPanel",()=>({checkTimeout:I(null)}),{persist:!0});const Xe=Symbol.for("vuetify:selection-control-group"),Pe=le({color:String,disabled:Boolean,defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:ae,trueIcon:ae,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:at},...Be(),...Vt(),...lt()},"SelectionControlGroup"),Gt=le({...Pe({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup"),Nt=oe()({name:"VSelectionControlGroup",props:Gt(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const l=Ie(e,"modelValue"),f=Ce(),n=D(()=>e.id||`v-selection-control-group-${f}`),c=D(()=>e.name||n.value),o=new Set;return ot(Xe,{modelValue:l,forceUpdate:()=>{o.forEach(r=>r())},onForceUpdate:r=>{o.add(r),nt(()=>{o.delete(r)})}}),st({[e.defaultsTarget]:{color:F(e,"color"),disabled:F(e,"disabled"),density:F(e,"density"),error:F(e,"error"),inline:F(e,"inline"),modelValue:l,multiple:D(()=>!!e.multiple||e.multiple==null&&Array.isArray(l.value)),name:c,falseIcon:F(e,"falseIcon"),trueIcon:F(e,"trueIcon"),readonly:F(e,"readonly"),ripple:F(e,"ripple"),type:F(e,"type"),valueComparator:F(e,"valueComparator")}}),ue(()=>{var r;return t("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class],style:e.style,role:e.type==="radio"?"radiogroup":void 0},[(r=a.default)==null?void 0:r.call(a)])}),{}}}),Je=le({label:String,trueValue:null,falseValue:null,value:null,...Be(),...Pe()},"VSelectionControl");function Ut(e){const s=rt(Xe,void 0),{densityClasses:a}=Dt(e),l=Ie(e,"modelValue"),f=D(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),n=D(()=>e.falseValue!==void 0?e.falseValue:!1),c=D(()=>!!e.multiple||e.multiple==null&&Array.isArray(l.value)),o=D({get(){const y=s?s.modelValue.value:l.value;return c.value?y.some(i=>e.valueComparator(i,f.value)):e.valueComparator(y,f.value)},set(y){if(e.readonly)return;const i=y?f.value:n.value;let p=i;c.value&&(p=y?[...Me(l.value),i]:Me(l.value).filter(w=>!e.valueComparator(w,f.value))),s?s.modelValue.value=p:l.value=p}}),{textColorClasses:r,textColorStyles:d}=At(D(()=>o.value&&!e.error&&!e.disabled?e.color:void 0)),h=D(()=>o.value?e.trueIcon:e.falseIcon);return{group:s,densityClasses:a,trueValue:f,falseValue:n,model:o,textColorClasses:r,textColorStyles:d,icon:h}}const Qe=oe()({name:"VSelectionControl",directives:{Ripple:xt},inheritAttrs:!1,props:Je(),emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:a,slots:l}=s;const{group:f,densityClasses:n,icon:c,model:o,textColorClasses:r,textColorStyles:d,trueValue:h}=Ut(e),y=Ce(),i=D(()=>e.id||`input-${y}`),p=q(!1),w=q(!1),$=I();f==null||f.onForceUpdate(()=>{$.value&&($.value.checked=o.value)});function R(A){p.value=!0,(!ze||ze&&A.target.matches(":focus-visible"))&&(w.value=!0)}function T(){p.value=!1,w.value=!1}function L(A){e.readonly&&f&&ut(()=>f.forceUpdate()),o.value=A.target.checked}return ue(()=>{var P,W;const A=l.label?l.label({label:e.label,props:{for:i.value}}):e.label,[g,x]=Ke(a);return t("div",se({class:["v-selection-control",{"v-selection-control--dirty":o.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":p.value,"v-selection-control--focus-visible":w.value,"v-selection-control--inline":e.inline},n.value,e.class]},g,{style:e.style}),[t("div",{class:["v-selection-control__wrapper",r.value],style:d.value},[(P=l.default)==null?void 0:P.call(l),N(t("div",{class:["v-selection-control__input"]},[c.value&&t(K,{key:"icon",icon:c.value},null),t("input",se({ref:$,checked:o.value,disabled:e.disabled,id:i.value,onBlur:T,onFocus:R,onInput:L,"aria-disabled":e.readonly,type:e.type,value:h.value,name:e.name,"aria-checked":e.type==="checkbox"?o.value:void 0},x),null),(W=l.input)==null?void 0:W.call(l,{model:o,textColorClasses:r,textColorStyles:d,props:{onFocus:R,onBlur:T,id:i.value}})]),[[it("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),A&&t(We,{for:i.value,clickable:!0},{default:()=>[A]})])}),{isFocused:p,input:$}}}),Ft=le({...Je({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Lt=oe()({name:"VRadio",props:Ft(),setup(e,s){let{slots:a}=s;return ue(()=>t(Qe,se(e,{class:["v-radio",e.class],style:e.style,type:"radio"}),a)),{}}});const jt=le({height:{type:[Number,String],default:"auto"},...Rt(),...dt(Pe(),["multiple"]),trueIcon:{type:ae,default:"$radioOn"},falseIcon:{type:ae,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Ht=oe()({name:"VRadioGroup",inheritAttrs:!1,props:jt(),emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:a,slots:l}=s;const f=Ce(),n=D(()=>e.id||`radio-group-${f}`),c=Ie(e,"modelValue");return ue(()=>{const[o,r]=Ke(a),[d,h]=Ne.filterProps(e),[y,i]=Qe.filterProps(e),p=l.label?l.label({label:e.label,props:{for:n.value}}):e.label;return t(Ne,se({class:["v-radio-group",e.class],style:e.style},o,d,{modelValue:c.value,"onUpdate:modelValue":w=>c.value=w,id:n.value}),{...l,default:w=>{let{id:$,messagesId:R,isDisabled:T,isReadonly:L}=w;return t(Z,null,[p&&t(We,{id:$.value},{default:()=>[p]}),t(Nt,se(y,{id:$.value,"aria-describedby":R.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:T.value,readonly:L.value,"aria-labelledby":p?$.value:void 0,multiple:!1},r,{modelValue:c.value,"onUpdate:modelValue":A=>c.value=A}),l)])}})}),{}}}),Kt={class:"block text-center font-weight-bold"},Yt={__name:"CommentDialog",props:["title","type"],emits:["submit"],setup(e,{emit:s}){const a=e;$e();const l=I(0),f=I("");return(n,c)=>(B(),ee(Te,{class:"dialog","z-index":"99999"},{default:m(()=>[t(re,{class:"bg-white rounded-xl px-8 pt-5 pb-8"},{default:m(()=>[u("div",Kt,k(a.title),1),a.type&&a.type==="cancel"?(B(),ee(Ht,{key:0},{default:m(()=>[t(Lt,{class:"radio"})]),_:1})):ct("",!0),t(Se,{class:"yellow-border","hide-details":"",variant:"underlined",color:"brand","append-inner-icon":"mdi-arrow-right text-brand",modelValue:f.value,"onUpdate:modelValue":c[0]||(c[0]=o=>f.value=o),"onClick:appendInner":c[1]||(c[1]=o=>s("submit",f.value,l.value))},null,8,["modelValue"])]),_:1})]),_:1}))}},Ze=ie(Yt,[["__scopeId","data-v-f635883f"]]),qt=["src"],Wt={class:"font-15 block ml-2"},Xt={class:"d-flex flex-row align-center justify-space-between"},Jt={class:"font-weight-medium"},Qt={class:"font-weight-medium d-flex align-center"},Zt={class:"star",style:{position:"relative",width:"22.5px",height:"22.5px"}},ea={class:"d-flex flex-row align-center justify-space-between"},ta={class:"text-graydarker"},aa={class:"font-weight-medium"},la={class:"d-flex flex-row"},oa={class:"nowrap"},na=u("div",{class:"block dotted-line"},null,-1),sa={class:"nowrap"},ia={__name:"DriverInterface",setup(e){const s=Re(),a=ve(),l=Ae(),f=zt(),n=fe(),c=I(!1),o=I({}),r=I(1002),d=I(!1),h=I(!1),y=I(!1),i=I("");function p(){c.value=!1,y.value=!0}function w(){s.stopDrawInterval(),a.pointA={},a.pointB={},a.showLoader=!1,s.pointA={},s.pointB={},s.debouncedClearDirection(),clearTimeout(f.checkTimeout),L()}function $(){n.mode="stand-by",y.value=!1}function R(){const g=document.createElement("a");g.href=`tel:${i.value}`,g.click()}async function T(){try{const g=await z.getBookingDetails(l.bookingId);console.log("GET_BOOKING_DETAILS",g),o.value={name:g.data.data.driver.fullName,rating:g.data.data.driver.rating,carModel:`${g.data.data.vehicle_details.vehicle_make} ${g.data.data.vehicle_details.vehicle_model} `,carNumber:g.data.data.vehicle_details.vehicle_number},i.value=g.data.data.driver.phoneNumber,console.log(i),l.driver={...o.value}}catch(g){console.log(g)}}async function L(){try{const g=await z.cancelBooking(l.bookingId);console.log(g)}catch(g){console.log(g)}}async function A(){try{const g=await z.checkBookingStatus(l.bookingId);if(console.log("CHECK_BOOKING_STATUS",g),g.data.data.booking_status==="1002")d.value||(d.value=!0,s.stopDrawInterval(),s.updatePoints("driver-position"),s.debouncedDrawDirection(),s.startDrawInterval("driver-position")),r.value=1002;else if(g.data.data.booking_status==="1003")d.value||(d.value=!0,s.stopDrawInterval(),s.updatePoints("driver-position"),s.debouncedDrawDirection(),s.startDrawInterval("driver-position")),r.value=1003;else if(g.data.data.booking_status==="1004")h.value||(h.value=!0,s.stopDrawInterval(),s.updatePoints("my-position"),s.debouncedDrawDirection(),s.startDrawInterval("my-position")),r.value=1004;else if(g.data.data.booking_status==="1005"){s.stopDrawInterval(),r.value=1005,clearTimeout(f.checkTimeout),n.mode="check";return}else if(g.data.data.booking_status==="1007"){s.stopDrawInterval(),r.value=1007,clearTimeout(f.checkTimeout),y.value=!0,l.$reset();return}f.checkTimeout=setTimeout(A,2e3)}catch(g){console.log(g)}}return Ve(()=>{T(),A()}),(g,x)=>(B(),Y(Z,null,[t(Ze,{modelValue:c.value,"onUpdate:modelValue":x[0]||(x[0]=P=>c.value=P),title:g.$t("reason"),type:"cancel",onSubmit:p},null,8,["modelValue","title"]),t(Oe,{modelValue:y.value,"onUpdate:modelValue":x[1]||(x[1]=P=>y.value=P),title:g.$t("canceled").split(" ").slice(1).join(" ").charAt(0).toUpperCase()+g.$t("canceled").split(" ").slice(1).join(" ").slice(1),onCloseMe:x[2]||(x[2]=P=>{w(),$()})},null,8,["modelValue","title"]),t(M,null,{default:m(()=>[t(O,{class:"d-flex flex-row justify-space-between align-center font-weight-medium text-blackish"},{default:m(()=>[N(u("div",null,k(g.$t("arrive")),513),[[j,r.value===1002]]),N(u("div",null,k(g.$t("driver_arrived")),513),[[j,r.value===1003]]),N(u("div",null,k(g.$t("started")),513),[[j,r.value===1004]]),N(u("div",null,"-",512),[[j,r.value===1002||r.value===1004]]),N(t(re,{class:"bg-brand px-2 rounded-lg"},{default:m(()=>[H(k(V(s).timeEstimate)+" "+k(g.$t("min"))+" "+k(g.$t("left")),1)]),_:1},512),[[j,r.value===1002||r.value===1004]])]),_:1})]),_:1}),t(M,null,{default:m(()=>[t(O,{class:"d-flex flex-row justify-start align-center pt-0"},{default:m(()=>[o.value.avatar?(B(),Y("img",{key:0,src:o.value.avatar,alt:"avatar"},null,8,qt)):(B(),ee(It,{key:1,color:"graydark",size:"large"})),u("div",Wt,[u("div",Xt,[u("div",Jt,k(o.value.name),1),u("div",Qt,[u("div",Zt,[t(K,{style:{opacity:.35},icon:"mdi-star",color:"brand"}),u("div",{class:"star-mask",style:xe({position:"absolute",top:0,width:`${o.value.rating*20*.8235}%`,overflow:"hidden"})},[t(K,{style:{opacity:1},icon:"mdi-star",color:"brand"})],4)]),u("div",null,k(o.value.rating),1)])]),u("div",ea,[u("div",ta,k(o.value.carModel),1),u("div",aa,k(o.value.carNumber),1)])])]),_:1})]),_:1}),t(M,null,{default:m(()=>[t(O,{class:"font-15"},{default:m(()=>[u("div",la,[u("div",oa,k(g.$t("amount")),1),na,u("div",sa,k(V(l).price)+" ₸",1)])]),_:1})]),_:1}),t(M,null,{default:m(()=>[t(O,{class:"d-flex flex-row justify-space-around align-center"},{default:m(()=>[t(U,{class:"bg-brand",icon:"mdi-phone",size:"x-large",onClick:x[3]||(x[3]=P=>R())}),t(U,{class:"bg-brand",icon:"mdi-message",size:"x-large",onClick:x[4]||(x[4]=P=>V(n).mode="chat")}),t(U,{class:"bg-brand",icon:"mdi-close-thick",size:"x-large",onClick:x[5]||(x[5]=P=>c.value=!0)})]),_:1})]),_:1})],64))}};const Ee=e=>(Ye("data-v-a893c940"),e=e(),qe(),e),ra={class:"font-weight-medium one-liner"},ua={class:"font-weight-medium one-liner"},da={class:"d-flex flex-row align-center justify-space-between"},ca={class:"font-weight-medium"},va={class:"font-weight-medium"},fa={class:"d-flex flex-row align-center justify-space-between"},ma={class:"text-graydarker"},pa={class:"font-weight-medium"},_a={class:"font-weight-medium mb-3"},ga={class:"d-flex flex-row"},ya={class:"nowrap"},ha=Ee(()=>u("div",{class:"block dotted-line"},null,-1)),ba={class:"nowrap"},ka={class:"d-flex flex-row"},wa={class:"nowrap"},Sa=Ee(()=>u("div",{class:"block dotted-line"},null,-1)),Ia={class:"nowrap"},Ca={class:"d-flex flex-row"},$a={class:"nowrap"},Va=Ee(()=>u("div",{class:"block dotted-line"},null,-1)),xa={class:"nowrap"},Da={class:"font-weight-bold text-center"},Aa={class:"d-flex flex-row align-center justify-center"},Ra={class:"d-flex flex-row justify-center"},Ta={class:"text-graydarker"},Oa={class:"d-flex flex-row justify-center pt-4"},Ba={__name:"CheckInterface",setup(e){const s=Re(),a=ve(),l=Ae(),f=fe(),n=I(!1),c=I(!1),o=I(0);function r(){n.value=!1}function d(){a.pointA={},a.pointB={},s.pointA={},s.pointB={},s.debouncedClearDirection(),f.mode="stand-by",l.$reset()}function h(i){o.value=i,console.log(i),console.log(o.value)}async function y(){if(!l.isRated)try{l.rating=o.value;const i={segment_slug:1,booking_order_id:l.bookingId,rating:o.value};await z.rateDriver(i),l.isRated=!0,c.value=!0}catch(i){console.log(i)}}return(i,p)=>(B(),Y(Z,null,[t(Ze,{modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=w=>n.value=w),title:i.$t("add_comment"),onSubmit:r},null,8,["modelValue","title"]),t(Oe,{modelValue:c.value,"onUpdate:modelValue":p[1]||(p[1]=w=>c.value=w),title:o.value?i.$t("thanks_rating"):i.$t("completed"),onCloseMe:p[2]||(p[2]=w=>{d(),c.value=!1})},null,8,["modelValue","title"]),t(M,null,{default:m(()=>[t(O,null,{default:m(()=>[t(St,{title:i.$t("ride_ended"),onClicked:p[3]||(p[3]=w=>c.value=!0)},null,8,["title"])]),_:1})]),_:1}),t(M,null,{default:m(()=>[t(O,{class:"py-0 d-flex flex-row justify-center"},{default:m(()=>[t(re,{class:"bg-brand text-blackish font-weight-bold rounded-lg px-2"},{default:m(()=>[H(k(V(l).price)+" "+k(i.$t("t").toUpperCase()),1)]),_:1})]),_:1})]),_:1}),t(M,null,{default:m(()=>[t(O,{class:"font-15"},{default:m(()=>[u("div",ra,[t(K,{icon:"mdi-circle-outline text-red"}),H(" "+k(V(l).pointA.name),1)]),u("div",ua,[t(K,{icon:"mdi-circle-outline"}),H(" "+k(V(l).pointB.name),1)])]),_:1})]),_:1}),t(M,null,{default:m(()=>[t(O,{class:"font-15"},{default:m(()=>[u("div",da,[u("div",ca,k(V(l).driver.name),1),u("div",va,[t(K,{icon:"mdi-star"}),H(" "+k(V(l).driver.raiting),1)])]),u("div",fa,[u("div",ma,k(V(l).driver.carModel),1),u("div",pa,k(V(l).driver.carNumber),1)])]),_:1})]),_:1}),t(M,null,{default:m(()=>[t(O,{class:"font-15"},{default:m(()=>[u("div",_a,k(i.$t("ride_info")),1),u("div",ga,[u("div",ya,k(i.$t("distance")),1),ha,u("div",ba,k(V(l).distanceEstimate),1)]),u("div",ka,[u("div",wa,k(i.$t("duration").split(" ")[0]),1),Sa,u("div",Ia,k(V(l).timeEstimate),1)]),u("div",Ca,[u("div",$a,k(i.$t("amount")),1),Va,u("div",xa,k(V(l).price)+"T",1)])]),_:1})]),_:1}),t(M,null,{default:m(()=>[t(O,null,{default:m(()=>[u("div",Da,k(i.$t("rate")),1),u("div",Aa,[(B(),Y(Z,null,De(5,w=>t(U,{class:"star",style:xe({opacity:w<=o.value?1:.35}),key:w,icon:"mdi-star",variant:"text",color:"brand",onClick:$=>h(w)},null,8,["style","onClick"])),64))]),u("div",Ra,[t(U,{class:"font-15 yellow-border",variant:"text",disabled:o.value===0,onClick:p[4]||(p[4]=w=>n.value=!0)},{default:m(()=>[u("span",Ta,k(i.$t("add_comment")),1)]),_:1},8,["disabled"])]),u("div",Oa,[t(U,{class:"round",color:"brand",size:"small",disabled:o.value===0,onClick:p[5]||(p[5]=w=>y())},{default:m(()=>[H(k(i.$t("review")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})],64))}},Pa=ie(Ba,[["__scopeId","data-v-a893c940"]]),Ea="/assets/card-3175eaa1.svg",Ma={class:"d-flex flex-column justify-center align-center block"},za={class:"text-white font-weight-bold"},Ga={__name:"ThankDialog",emits:["closeMe"],setup(e,{emit:s}){return(a,l)=>(B(),ee(Te,null,{default:m(()=>[u("div",Ma,[t(U,{class:"bg-brand",icon:"mdi-heart text-white",size:"x-large",onClick:l[0]||(l[0]=f=>s("closeMe"))}),u("div",za,k(a.$t("thanks_ride")),1)])]),_:1}))}},et=He("payment",()=>{const e=I(1);return{isCard:I(!1),paymentId:e}},{persist:!0});const Na={class:"text-blackish font-weight-bold mb-3"},Ua={class:"block mb-3"},Fa=["onClick"],La={class:"payment-text"},ja=["value"],Ha={class:"d-flex flex-row justify-space-between"},Ka={class:"text-white"},Ya={__name:"PaymentMethodDialog",emits:["closeMe"],setup(e,{emit:s}){const a=$e(),l=I([{id:0,system:"cash",preview:a.t("cash")}]),f=I(0),n=I(0),c=et();Q(n,()=>{l.value[n.value].system==="cash"?(f.value=1,c.isCard=!1,c.paymentId=1):(f.value=2,c.isCard=!0,c.paymentId=l.value[n.value].id)});function o(d){switch(d){case"cash":return"mdi-cash-multiple";case"visa":return"mdi-card-bulleted-outline ";case"master":return"mdi-card-bulleted ";default:return""}}async function r(){try{const h=(await z.getCards()).data.data.map(y=>({id:y.id,system:"visa",preview:y.card_number.slice(-4)}));l.value.push(...h)}catch(d){console.log(d)}}return r(),(d,h)=>(B(),ee(Te,{class:"dialog","z-index":"99999"},{default:m(()=>[t(re,{class:"bg-white rounded-lg px-7 pt-3 pb-4 d-flex flex-column justify-center align-center"},{default:m(()=>[u("div",Na,k(d.$t("payment_method")),1),u("div",Ua,[(B(!0),Y(Z,null,De(l.value,y=>(B(),Y("div",{class:"d-flex flex-row justify-space-between border-bottom mb-2",key:y.id,onClick:i=>n.value=y.id},[u("div",La,[t(K,{class:"mr-3",icon:o(y.system)},null,8,["icon"]),H(" "+k(y.preview),1)]),u("div",null,[N(u("input",{type:"radio",value:y.id,"onUpdate:modelValue":h[0]||(h[0]=i=>n.value=i)},null,8,ja),[[vt,n.value]])])],8,Fa))),128)),u("div",Ha,[t(U,{class:"pa-1 mr-3 payment-text","prepend-icon":"mdi-plus-box-outline",variant:"text",density:"compact",to:{name:"AddPaymentMethod"}},{default:m(()=>[H(k(d.$t("add_card")),1)]),_:1})])]),t(U,{class:"bg-brand",onClick:h[1]||(h[1]=y=>s("closeMe"))},{default:m(()=>[u("span",Ka,k(d.$t("ready")),1)]),_:1})]),_:1})]),_:1}))}},qa=ie(Ya,[["__scopeId","data-v-c72f2caa"]]);function Le(e){const a=Math.abs(e);return Math.sign(e)*(a/((1/.501-2)*(1-a)+1))}function je(e){let{selectedElement:s,containerSize:a,contentSize:l,isRtl:f,currentScrollOffset:n,isHorizontal:c}=e;const o=c?s.clientWidth:s.clientHeight,r=c?s.offsetLeft:s.offsetTop,d=f&&c?l-r-o:r,h=a+n,y=o+d,i=o*.4;return d<=n?n=Math.max(d-i,0):h<=y&&(n=Math.min(n-(h-y-i),l-a)),n}function Wa(e){let{selectedElement:s,containerSize:a,contentSize:l,isRtl:f,isHorizontal:n}=e;const c=n?s.clientWidth:s.clientHeight,o=n?s.offsetLeft:s.offsetTop,r=f&&n?l-o-c/2-a/2:o+c/2-a/2;return Math.min(l-a,Math.max(0,r))}const tt=Symbol.for("vuetify:v-slide-group"),Xa=le({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:tt},nextIcon:{type:ae,default:"$next"},prevIcon:{type:ae,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...Be(),...Mt(),...Tt({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),Ja=oe()({name:"VSlideGroup",props:Xa(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{isRtl:l}=ft(),{mobile:f}=mt(),n=Ot(e,e.symbol),c=q(!1),o=q(0),r=q(0),d=q(0),h=D(()=>e.direction==="horizontal"),{resizeRef:y,contentRect:i}=Fe(),{resizeRef:p,contentRect:w}=Fe(),$=D(()=>n.selected.value.length?n.items.value.findIndex(b=>b.id===n.selected.value[0]):-1),R=D(()=>n.selected.value.length?n.items.value.findIndex(b=>b.id===n.selected.value[n.selected.value.length-1]):-1);if(pt){let b=-1;Q(()=>[n.selected.value,i.value,w.value,h.value],()=>{cancelAnimationFrame(b),b=requestAnimationFrame(()=>{if(i.value&&w.value){const C=h.value?"width":"height";r.value=i.value[C],d.value=w.value[C],c.value=r.value+1<d.value}if($.value>=0&&p.value){const C=p.value.children[R.value];$.value===0||!c.value?o.value=0:e.centerActive?o.value=Wa({selectedElement:C,containerSize:r.value,contentSize:d.value,isRtl:l.value,isHorizontal:h.value}):c.value&&(o.value=je({selectedElement:C,containerSize:r.value,contentSize:d.value,isRtl:l.value,currentScrollOffset:o.value,isHorizontal:h.value}))}})})}const T=q(!1);let L=0,A=0;function g(b){const C=h.value?"clientX":"clientY";A=(l.value&&h.value?-1:1)*o.value,L=b.touches[0][C],T.value=!0}function x(b){if(!c.value)return;const C=h.value?"clientX":"clientY",E=l.value&&h.value?-1:1;o.value=E*(A+L-b.touches[0][C])}function P(b){const C=d.value-r.value;o.value<0||!c.value?o.value=0:o.value>=C&&(o.value=C),T.value=!1}function W(){y.value&&(y.value[h.value?"scrollLeft":"scrollTop"]=0)}const X=q(!1);function de(b){if(X.value=!0,!(!c.value||!p.value)){for(const C of b.composedPath())for(const E of p.value.children)if(E===C){o.value=je({selectedElement:E,containerSize:r.value,contentSize:d.value,isRtl:l.value,currentScrollOffset:o.value,isHorizontal:h.value});return}}}function me(b){X.value=!1}function pe(b){var C;!X.value&&!(b.relatedTarget&&((C=p.value)!=null&&C.contains(b.relatedTarget)))&&G()}function _e(b){p.value&&(h.value?b.key==="ArrowRight"?G(l.value?"prev":"next"):b.key==="ArrowLeft"&&G(l.value?"next":"prev"):b.key==="ArrowDown"?G("next"):b.key==="ArrowUp"&&G("prev"),b.key==="Home"?G("first"):b.key==="End"&&G("last"))}function G(b){var C,E,ce,v,_;if(p.value)if(!b)(C=_t(p.value)[0])==null||C.focus();else if(b==="next"){const S=(E=p.value.querySelector(":focus"))==null?void 0:E.nextElementSibling;S?S.focus():G("first")}else if(b==="prev"){const S=(ce=p.value.querySelector(":focus"))==null?void 0:ce.previousElementSibling;S?S.focus():G("last")}else b==="first"?(v=p.value.firstElementChild)==null||v.focus():b==="last"&&((_=p.value.lastElementChild)==null||_.focus())}function te(b){const C=o.value+(b==="prev"?-1:1)*r.value;o.value=gt(C,0,d.value-r.value)}const ge=D(()=>{let b=o.value>d.value-r.value?-(d.value-r.value)+Le(d.value-r.value-o.value):-o.value;o.value<=0&&(b=Le(-o.value));const C=l.value&&h.value?-1:1;return{transform:`translate${h.value?"X":"Y"}(${C*b}px)`,transition:T.value?"none":"",willChange:T.value?"transform":""}}),J=D(()=>({next:n.next,prev:n.prev,select:n.select,isSelected:n.isSelected})),ne=D(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!f.value;case!0:return c.value||Math.abs(o.value)>0;case"mobile":return f.value||c.value||Math.abs(o.value)>0;default:return!f.value&&(c.value||Math.abs(o.value)>0)}}),ye=D(()=>Math.abs(o.value)>0),he=D(()=>d.value>Math.abs(o.value)+r.value);return ue(()=>t(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!h.value,"v-slide-group--has-affixes":ne.value,"v-slide-group--is-overflowing":c.value},e.class],style:e.style,tabindex:X.value||n.selected.value.length?-1:0,onFocus:pe},{default:()=>{var b,C,E;return[ne.value&&t("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!ye.value}],onClick:()=>te("prev")},[((b=a.prev)==null?void 0:b.call(a,J.value))??t(Ue,null,{default:()=>[t(K,{icon:l.value?e.nextIcon:e.prevIcon},null)]})]),t("div",{key:"container",ref:y,class:"v-slide-group__container",onScroll:W},[t("div",{ref:p,class:"v-slide-group__content",style:ge.value,onTouchstartPassive:g,onTouchmovePassive:x,onTouchendPassive:P,onFocusin:de,onFocusout:me,onKeydown:_e},[(C=a.default)==null?void 0:C.call(a,J.value)])]),ne.value&&t("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!he.value}],onClick:()=>te("next")},[((E=a.next)==null?void 0:E.call(a,J.value))??t(Ue,null,{default:()=>[t(K,{icon:l.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:n.selected,scrollTo:te,scrollOffset:o,focus:G}}}),Qa=oe()({name:"VSlideGroupItem",props:Bt(),emits:{"group:selected":e=>!0},setup(e,s){let{slots:a}=s;const l=Pt(e,tt);return()=>{var f;return(f=a.default)==null?void 0:f.call(a,{isSelected:l.isSelected.value,select:l.select,toggle:l.toggle,selectedClass:l.selectedClass.value})}}}),Za=e=>(Ye("data-v-69e0953c"),e=e(),qe(),e),el=["onClick"],tl={class:"car-img"},al=["src"],ll={class:"text-center"},ol={class:"text-center",style:{"font-size":"15px"}},nl=Za(()=>u("img",{src:Ea,alt:"card"},null,-1)),sl={class:"text-white"},il={__name:"OrderInterface",setup(e){const s=Re(),a=Ae(),l=et(),f=Et(),n=ve(),c=fe(),{point:o,pointA:r,pointB:d,pointAName:h,pointBName:y}=we(n),{mode:i}=we(c),p=$e(),w=I(!1),$=I(!1),R=I(0),T=I(void 0),L=I(void 0),A=I(null),g=I(null),x=I(!1),P=I(""),W=I(!0);Ve(()=>{i.value==="pick-car"&&(i.value="stand-by"),i.value==="pre-order"&&(n.pointA={...a.pointA},n.pointB={...a.pointB},n.pointAName=a.pointA.name,n.pointBName=a.pointB.name,s.triggerPositionMap(),a.bookingId===null?(n.showLoader=!0,J()):E()),i.value==="stand-by"&&document.getElementById("firstInput").focus()});const X=D(()=>Object.keys(r.value).length!==0&&Object.keys(d.value).length!==0&&r.value.name!==d.value.name);Q(i,()=>{i.value==="stand-by"&&(f.focusInput="A",f.readPointer=!0)},{immediate:!0}),Q(X,()=>{X.value&&(s.pointA={...n.pointA},s.pointB={...n.pointB},s.debouncedDrawDirection(),i.value!=="pre-order"&&ge())},{immediate:!0}),Q(o,()=>{f.readPointer&&(f.focusInput==="A"?r.value={...o.value}:f.focusInput==="B"&&(d.value={...o.value}),Object.keys(r.value).length&&Object.keys(d.value).length&&(s.pointA={...n.pointA},s.pointB={...n.pointB},s.debouncedDrawDirection()))},{immediate:!0});function de(v){v==="A"?(h.value="",r.value={}):v==="B"&&(y.value="",d.value={}),i.value!=="pre-order"&&(i.value="stand-by",f.showPanel=!0,f.readPointer=!1,f.focusInput=v,ht.push({name:"SearchResults"}))}function me(){try{console.log("trying to make an order"),i.value="pre-order",n.showLoader=!0,s.triggerPositionMap(),a.pointB={...n.pointB},a.pointA={...n.pointA},a.carId=T.value[R.value].id,console.log(`carGroup.value[carSelect.value].estimate_fare ${T.value[R.value].estimate_fare}`),a.price=Number(T.value[R.value].estimate_fare.toString().split(" ")[0]),console.log(a);try{J()}catch(v){console.log(v)}}catch(v){console.log(v)}}function pe(){r.value={},d.value={},n.showLoader=!1,clearTimeout(L.value),s.debouncedClearDirection(),ce(),P.value=p.t("canceled"),x.value=!0,a.$reset()}function _e(){x.value=!1,n.showLoader=!1,i.value="stand-by",a.$reset()}function G(v){if(l.isCard){let[_,S]=v.split(" ");return`${Math.ceil(Number(_)*1.05)} ${S}`}return v}function te(v){return`https://2gis.kz/almaty/geo/${v.building_id}/${v.coordinates[0]},${v.coordinates[1]}`}async function ge(){const v={latitude:`${r.value.coordinates[1]}`,segment_id:1,drop_location:JSON.stringify([{stop:1,drop_latitude:`${d.value.coordinates[1]}`,drop_longitude:`${d.value.coordinates[0]}`,drop_location:d.value.name}]),longitude:`${r.value.coordinates[0]}`};try{const _=await z.getCars(v);console.log("CARS RESULT ",_),a.areaId=_.data.data.response_data.id,T.value=_.data.data.response_data.service_types[0].vehicles,i.value="pick-car",W.value=!1}catch(_){console.log(_)}}async function J(){try{const v={area:a.areaId,service_type:1,distance:5,latitude:`${a.pointA.coordinates[1]}`,vehicle_type:a.carId,segment_id:1,longitude:`${a.pointA.coordinates[0]}`};console.log("trying to find driver = "+v);const _=6*1e3,S=new Promise(ke=>{setTimeout(()=>{console.log("1-minute countdown finished"),ke()},_)}),be=await z.findDriver(v);await S,be.data.message!=="Data not found"&&ne()}catch(v){console.log(v)}}async function ne(){try{const v={service_type:1,area_id:a.areaId,latitude:`${d.value.coordinates[1]}`,longitude:`${d.value.coordinates[0]}`};await z.checkDropArea(v),ye()}catch(v){console.log(v)}}async function ye(){try{const v={total_ride_amount:a.price,area:a.areaId,later_time:null,service_package_id:null,pickup_longitude:a.pointA.coordinates[0],vehicle_type:a.carId,total_drop_location:1,service_type:1,pickup_latitude:a.pointA.coordinates[1],later_date:null,booking_type:1,pick_up_location:a.pointA.name,segment_id:1,number_of_rider:0,drop_location:JSON.stringify([{stop:1,drop_latitude:a.pointB.coordinates[1],drop_longitude:a.pointB.coordinates[0],drop_location:a.pointB.name,status:1}])},_=await z.checkoutRide(v);A.value=_.data.data.id,a.timeEstimate=_.data.data.estimate_time,a.distanceEstimate=_.data.data.estimate_distance,b()}catch(v){console.log(v)}}async function he(){try{const v={booking_id:a.bookingId,point_a_link:te(a.pointA),point_b_link:te(a.pointB)};await z.sendNavigatorLinks(v),E()}catch(v){console.log(v)}}async function b(){try{await z.checkoutPayment({checkout:A.value,payment_method_id:1}),C()}catch(v){console.log(v)}}async function C(){try{const v={segment_id:1,checkout:A.value},_=await z.confirmBooking(v);a.bookingId=_.data.data.id,console.log("CONFIRM_BOOKING",a.bookingId),he()}catch(v){n.showLoader=!1,console.log(v)}}async function E(){try{n.showLoader=!0;const v=await z.checkBookingStatus(a.bookingId);console.log("CHECK_BOOKING_STATUS",v),v.data.data.booking_status==="1016"?(J(),clearTimeout(g.value)):v.data.data.booking_status==="1002"?(n.showLoader=!1,i.value="order-in-progress",clearTimeout(g.value)):g.value=setTimeout(E,2e3)}catch(v){console.log(v)}}async function ce(){try{await z.cancelPreBooking(a.bookingId)}catch(v){console.log(v)}}return(v,_)=>(B(),Y(Z,null,[t(Ga,{modelValue:w.value,"onUpdate:modelValue":_[0]||(_[0]=S=>w.value=S),onCloseMe:_[1]||(_[1]=S=>w.value=!1)},null,8,["modelValue"]),t(qa,{modelValue:$.value,"onUpdate:modelValue":_[2]||(_[2]=S=>$.value=S),onCloseMe:_[3]||(_[3]=S=>$.value=!1)},null,8,["modelValue"]),t(Oe,{modelValue:x.value,"onUpdate:modelValue":_[4]||(_[4]=S=>x.value=S),title:P.value,onCloseMe:_[5]||(_[5]=S=>_e())},null,8,["modelValue","title"]),N(t(M,null,{default:m(()=>[t(O,{class:"pb-0"},{default:m(()=>[t(Se,{label:v.$t("from"),variant:"outlined","prepend-inner-icon":"mdi-map-marker","hide-details":"",modelValue:V(h),"onUpdate:modelValue":_[6]||(_[6]=S=>Ge(h)?h.value=S:null),readonly:"",onClick:_[7]||(_[7]=S=>de("A")),id:"firstInput",style:{background:"#F5F5F5","box-shadow":"0px 0px 3px 0px rgba(0, 0, 0, 0.25)"}},null,8,["label","modelValue"])]),_:1})]),_:1},512),[[j,V(i)==="stand-by"||V(i)==="pick-car"||V(i)==="pre-order"]]),N(t(M,null,{default:m(()=>[t(O,null,{default:m(()=>[t(Se,{label:v.$t("to"),variant:"outlined","prepend-inner-icon":"mdi-arrow-top-left-thick","hide-details":"",modelValue:V(y),"onUpdate:modelValue":_[8]||(_[8]=S=>Ge(y)?y.value=S:null),readonly:"",onClick:_[9]||(_[9]=S=>de("B")),id:"secondInput",style:{background:"#F5F5F5","box-shadow":"0px 0px 3px 0px rgba(0, 0, 0, 0.25)"}},null,8,["label","modelValue"])]),_:1})]),_:1},512),[[j,V(i)==="stand-by"||V(i)==="pick-car"||V(i)==="pre-order"]]),N(t(M,null,{default:m(()=>[t(O,{class:"py-0"},{default:m(()=>[t(Ja,{modelValue:R.value,"onUpdate:modelValue":_[10]||(_[10]=S=>R.value=S),mandatory:""},{default:m(()=>[(B(!0),Y(Z,null,De(T.value,S=>(B(),ee(Qa,{key:S.id},{default:m(({isSelected:be,toggle:ke})=>[u("div",{onClick:ke,class:yt(["price-item px-2 font-13 font-weight-medium",{"selected-car":be}])},[u("div",tl,[u("img",{style:{"margin-inline":"auto",display:"block"},src:S.vehicleTypeImage},null,8,al)]),u("div",ll,k(S.vehicleTypeName),1),u("div",ol,k(G(S.estimate_fare)),1)],10,el)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},512),[[j,V(i)==="pick-car"]]),N(t(M,null,{default:m(()=>[t(O,{cols:"3"},{default:m(()=>[t(U,{height:"60",class:"round bg-brand font-weight-bold",block:"",onClick:_[11]||(_[11]=S=>$.value=!0)},{default:m(()=>[nl]),_:1})]),_:1}),t(O,null,{default:m(()=>[t(U,{block:"",height:"60",class:"round bg-brand font-weight-bold text-white",onClick:_[12]||(_[12]=S=>me()),disabled:W.value},{default:m(()=>[u("span",sl,k(v.$t("order")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},512),[[j,V(i)==="stand-by"||V(i)==="pick-car"]]),N(t(M,null,{default:m(()=>[t(O,{class:"d-flex justify-center"},{default:m(()=>[t(U,{"prepend-icon":"mdi-close",class:"round",color:"brand",size:"large",onClick:_[13]||(_[13]=S=>pe())},{default:m(()=>[H(k(v.$t("cancel")),1)]),_:1})]),_:1})]),_:1},512),[[j,V(i)==="pre-order"]])],64))}},rl=ie(il,[["__scopeId","data-v-69e0953c"]]);const ul={__name:"MainMap",setup(e){const s=ve(),a=fe(),{mode:l}=we(a),f={DriverInterface:ia,ChatInterface:$t,CheckInterface:Pa,OrderInterface:rl};let n,c=0;const o=I(""),r=I(!1),d=I(n);function h(p){r.value=!0,c=p.clientY}function y(p){if(r.value){const w=p.clientY-c,$=d.value-w,R=l.value==="order-in-progress";$>=n*.9&&(R&&$<=window.innerHeight||!R&&$<=n*1.1)&&(d.value-=w),c=p.clientY}}function i(){r.value=!1,l.value==="order-in-progress"&&d.value>window.innerHeight*.5?d.value=window.innerHeight*.95:d.value=n}return Ve(()=>{window.addEventListener("pointermove",y),window.addEventListener("pointerup",i)}),bt(()=>{window.removeEventListener("pointermove",y),window.removeEventListener("pointerup",i)}),Q(r,()=>{s.debouncedRerender()}),Q(l,()=>{switch(l.value="stand-by",l.value){case"stand-by":n=270,o.value="OrderInterface",s.debouncedRerender();break;case"pick-car":n=365,o.value="OrderInterface",s.debouncedRerender();break;case"pre-order":n=260,o.value="OrderInterface",s.debouncedRerender();break;case"order-in-progress":n=250,o.value="DriverInterface",s.debouncedRerender();break;case"chat":n=550,o.value="ChatInterface",s.debouncedRerender();break;case"check":n=550,o.value="CheckInterface",s.debouncedRerender();break;default:l.value="stand-by",n=260,o.value="OrderInterface",s.debouncedRerender();break}d.value=n},{immediate:!0}),(p,w)=>{const $=kt("router-view");return B(),Y("div",null,[t($,{class:"map"}),t(Ct,{class:"bottom-panel",style:xe({height:`${d.value}px`})},{toggler:m(()=>[t(re,{class:"bg-graydark rounded-lg toggler",width:"50",height:"5",onMousedown:h})]),content:m(()=>[(B(),ee(wt(f[o.value])))]),_:1},8,["style"])])}}},kl=ie(ul,[["__scopeId","data-v-154f31d3"]]);export{kl as default};
