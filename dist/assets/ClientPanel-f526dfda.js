import{V as z,u as H}from"./userPanel-b5620d02.js";import{a as M}from"./order-65aed67f.js";import{m as F,u as L,U as k}from"./user-7a776cf7.js";import{H as O}from"./HeaderRouter-2e3b5674.js";import{p,n as x,h as E,q as R,B as U,j as a,I as j,_ as I,r as y,l as C,P as V,w as t,M as S,N as h,T as G,K as b,V as q,m as A,a5 as K,R as J,ac as P}from"./index-47b4a022.js";import{p as Q,q as W,r as X,s as Y,t as T,v as Z,w as ee,x as ae,y as se,z as te,A as B,m as le,B as ne,C as oe,D as re,u as ue,E as ce,V as de,F as ie,f as _,g,e as me,o as ve}from"./VRow-06a8dd11.js";import{m as w,u as D}from"./useRender-5142e326.js";import{m as $}from"./tag-35f47c51.js";const fe=p({color:String,...Q(),...w(),...F(),...W(),...X(),...Y(),...T(),...$(),...x()},"VSheet"),N=E()({name:"VSheet",props:fe(),setup(e,n){let{slots:u}=n;const{themeClasses:m}=R(e),{backgroundColorClasses:o,backgroundColorStyles:c}=Z(U(e,"color")),{borderClasses:d}=ee(e),{dimensionStyles:v}=L(e),{elevationClasses:f}=ae(e),{locationStyles:i}=se(e),{positionClasses:s}=te(e),{roundedClasses:l}=B(e);return D(()=>a(e.tag,{class:["v-sheet",m.value,o.value,d.value,f.value,s.value,l.value,e.class],style:[c.value,v.value,i.value,e.style]},u)),{}}});const _e=p({start:Boolean,end:Boolean,icon:j,image:String,...w(),...le(),...T(),...ne(),...$(),...x(),...oe({variant:"flat"})},"VAvatar"),ge=E()({name:"VAvatar",props:_e(),setup(e,n){let{slots:u}=n;const{themeClasses:m}=R(e),{colorClasses:o,colorStyles:c,variantClasses:d}=re(e),{densityClasses:v}=ue(e),{roundedClasses:f}=B(e),{sizeClasses:i,sizeStyles:s}=ce(e);return D(()=>a(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},m.value,o.value,v.value,f.value,i.value,d.value,e.class],style:[c.value,s.value,e.style]},{default:()=>{var l;return[e.image?a(z,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?a(de,{key:"icon",icon:e.icon},null):(l=u.default)==null?void 0:l.call(u),ie(!1,"v-avatar")]}})),{}}});const Ce={class:"gray-buttom d-flex align-center justify-center pb-2 mx-5"},ye={class:"ml-2 text-graydarker"},ke={__name:"ChatInterface",setup(e){const n=M(),u=H();let m=null;const o=y(""),c=y(!1),d=y([]);function v(){clearInterval(m),u.mode="order-in-progress"}async function f(){c.value=!0;try{const s=await k.sendChatMessage(n.bookingId,o.value);i(),console.log("CHAT SEND",s)}catch(s){console.log("CHAT SEND ERROR",s)}c.value=!1,o.value=""}async function i(){try{const s=await k.getChat(n.bookingId);s.data.data===null?d.value=[]:d.value=s.data.data.chat,console.log("CHAT",s)}catch(s){console.log("CHAT ERROR",s)}}return i(),m=setInterval(i,3e3),(s,l)=>(C(),V(b,null,[a(g,null,{default:t(()=>[a(_,null,{default:t(()=>[a(O,{title:s.$t("chat"),onClicked:l[0]||(l[0]=r=>v())},null,8,["title"])]),_:1})]),_:1}),a(g,null,{default:t(()=>[a(_,{class:"py-0"},{default:t(()=>[S("div",Ce,[a(ge,{color:"graydark",size:"x-small"}),S("div",ye,h(G(n).driver.name),1)])]),_:1})]),_:1}),a(g,null,{default:t(()=>[a(_,{class:"messages-box d-flex flex-column"},{default:t(()=>[(C(!0),V(b,null,q(d.value,r=>(C(),A(N,{class:K(["py-1 px-5 mb-3 rounded-xl",{"bg-brand align-self-end":r.sender==="USER","bg-grey-lighten-2":r.sender==="DRIVER"}]),style:{width:"fit-content","word-break":"break-all"},key:r.timestamp},{default:t(()=>[J(h(r.message),1)]),_:2},1032,["class"]))),128))]),_:1})]),_:1}),a(g,null,{default:t(()=>[a(_,null,{default:t(()=>[a(me,{class:"bg-white",label:s.$t("your_message"),"append-icon":"mdi-send",modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=r=>o.value=r),loading:c.value,"onClick:append":l[2]||(l[2]=r=>f())},null,8,["label","modelValue","loading"])]),_:1})]),_:1})],64))}},Ae=I(ke,[["__scopeId","data-v-4537254b"]]);const Ve={};function Se(e,n){return C(),A(N,{class:"rounded-t-xl overflow-hidden client-panel"},{default:t(()=>[a(ve,null,{default:t(()=>[a(g,null,{default:t(()=>[a(_,{class:"d-flex justify-center pb-0 pt-2 mb-2"},{default:t(()=>[P(e.$slots,"toggler",{},void 0,!0)]),_:3})]),_:3}),P(e.$slots,"content",{},void 0,!0)]),_:3})]),_:3})}const Te=I(Ve,[["render",Se],["__scopeId","data-v-52ca81ae"]]);export{Te as C,N as V,ge as a,Ae as b};
