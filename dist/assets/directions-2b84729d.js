import{_ as Q,D as F,Q as H,T as Y,l as J,P as K,W as q,X as V,M as A}from"./index-47b4a022.js";import{u as X}from"./order-65aed67f.js";import{c as $}from"./_commonjsHelpers-725317a4.js";const tt=v=>(q("data-v-6f84ffe5"),v=v(),V(),v),et={class:"loader"},nt=tt(()=>A("div",{class:"radius-animation"},[A("div"),A("div"),A("div"),A("div")],-1)),rt=[nt],ot={__name:"Loader",setup(v){const E=X();return(x,d)=>F((J(),K("div",et,rt,512)),[[H,Y(E).showLoader]])}},ct=Q(ot,[["__scopeId","data-v-6f84ffe5"]]);var C={};Object.defineProperty(C,"__esModule",{value:!0});var it=C.load=void 0,T;function st(v){if(v===void 0&&(v="https://mapgl.2gis.com/api/js"),typeof window>"u")throw new Error("mapgl is supported only in browser environment");return T?Promise.resolve(T):at(v).then(function(){return T=window.mapgl,T})}it=C.load=st;function at(v){return new Promise(function(E,x){var d=document.createElement("script");d.type="text/javascript",d.async=!0,d.crossOrigin="anonymous",d.src=v,document.body.appendChild(d),d.addEventListener("load",function(){E()}),d.addEventListener("error",function(p){x(p)})})}var R={exports:{}};(function(v,E){(function(x,d){v.exports=d()})(typeof self<"u"?self:$,function(){return function(x){var d={};function p(s){if(d[s])return d[s].exports;var l=d[s]={i:s,l:!1,exports:{}};return x[s].call(l.exports,l,l.exports,p),l.l=!0,l.exports}return p.m=x,p.c=d,p.d=function(s,l,g){p.o(s,l)||Object.defineProperty(s,l,{enumerable:!0,get:g})},p.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},p.t=function(s,l){if(1&l&&(s=p(s)),8&l||4&l&&typeof s=="object"&&s&&s.__esModule)return s;var g=Object.create(null);if(p.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:s}),2&l&&typeof s!="string")for(var f in s)p.d(g,f,function(P){return s[P]}.bind(null,f));return g},p.n=function(s){var l=s&&s.__esModule?function(){return s.default}:function(){return s};return p.d(l,"a",l),l},p.o=function(s,l){return Object.prototype.hasOwnProperty.call(s,l)},p.p="/",p(p.s=1)}([function(x,d){x.exports=l,x.exports.parse=l,x.exports.stringify=function g(f){f.type==="Feature"&&(f=f.geometry);function P(a){return a.join(" ")}function _(a){return a.map(P).join(", ")}function N(a){return a.map(_).map(b).join(", ")}function b(a){return"("+a+")"}switch(f.type){case"Point":return"POINT ("+P(f.coordinates)+")";case"LineString":return"LINESTRING ("+_(f.coordinates)+")";case"Polygon":return"POLYGON ("+N(f.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+_(f.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+(f.coordinates.map(N).map(b).join(", ")+")");case"MultiLineString":return"MULTILINESTRING ("+N(f.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+f.geometries.map(g).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};var p=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,s=new RegExp("^"+p.source+"(\\s"+p.source+"){1,}");function l(g){var f,P=g.split(";"),_=P.pop(),N=(P.shift()||"").split("=").pop(),b=0;function a(i){var r=_.substring(b).match(i);return r?(b+=r[0].length,r[0]):null}function y(){a(/^\s*/)}function D(){y();for(var i,r=0,e=[],n=[e],t=e;i=a(/^(\()/)||a(/^(\))/)||a(/^(,)/)||a(s);){if(i==="(")n.push(t),t=[],n[n.length-1].push(t),r++;else if(i===")"){if(t.length===0||!(t=n.pop()))return null;if(--r===0)break}else if(i===",")t=[],n[n.length-1].push(t);else{if(i.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(t,i.split(/\s/g).map(parseFloat))}y()}return r!==0?null:e}function L(){for(var i,r,e=[];r=a(s)||a(/^(,)/);)r===","?(e.push(i),i=[]):r.split(/\s/g).some(isNaN)||(i||(i=[]),Array.prototype.push.apply(i,r.split(/\s/g).map(parseFloat))),y();return i?(e.push(i),e.length?e:null):null}function M(){return function(){if(!a(/^(point(\sz)?)/i)||(y(),!a(/^(\()/)))return null;var i=L();return i?(y(),a(/^(\))/)?{type:"Point",coordinates:i[0]}:null):null}()||function(){if(!a(/^(linestring(\sz)?)/i)||(y(),!a(/^(\()/)))return null;var i=L();return i&&a(/^(\))/)?{type:"LineString",coordinates:i}:null}()||function(){if(!a(/^(polygon(\sz)?)/i))return null;y();var i=D();return i?{type:"Polygon",coordinates:i}:null}()||function(){if(!a(/^(multipoint)/i))return null;y();var i=_.substring(_.indexOf("(")+1,_.length-1).replace(/\(/g,"").replace(/\)/g,"");_="MULTIPOINT ("+i+")";var r=D();return r?(y(),{type:"MultiPoint",coordinates:r}):null}()||function(){if(!a(/^(multilinestring)/i))return null;y();var i=D();return i?(y(),{type:"MultiLineString",coordinates:i}):null}()||function(){if(!a(/^(multipolygon)/i))return null;y();var i=D();return i?{type:"MultiPolygon",coordinates:i}:null}()||function(){var i,r=[];if(!a(/^(geometrycollection)/i)||(y(),!a(/^(\()/)))return null;for(;i=M();)r.push(i),y(),a(/^(,)/),y();return a(/^(\))/)?{type:"GeometryCollection",geometries:r}:null}()}return(f=M())&&N.match(/\d+/)&&(f.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+N}}),f}},function(x,d,p){p.r(d),p.d(d,"Directions",function(){return i});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */var s=function(r,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var o in t)t.hasOwnProperty(o)&&(n[o]=t[o])})(r,e)},l=function(){return(l=Object.assign||function(r){for(var e,n=1,t=arguments.length;n<t;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r}).apply(this,arguments)},g=0,f=1,P={fast:"#22aa01",normal:"#ffc402",slow:"#f72000","slow-jams":"#81020d","no-traffic":"#0f6ec1",ignore:"#0f6ec1",pedestrian:"#626262","pedestrian-underground":"#626262",inactive:"#b4bcd2",border:"#ffffff",border2:"#ff141414",hovered:"#000000"},_={size:[22,22],offset:[11,11],img:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMTUiIGQ9Ik0xMSAyMkMxNy4wNzUxIDIyIDIyIDE3LjA3NTEgMjIgMTFDMjIgNC45MjQ4NyAxNy4wNzUxIDAgMTEgMEM0LjkyNDg3IDAgMCA0LjkyNDg3IDAgMTFDMCAxNy4wNzUxIDQuOTI0ODcgMjIgMTEgMjJaIi8+CiAgPHBhdGggZmlsbD0iI2ZmZmZmZiIgZD0iTTExIDIxQzE2LjUyMjggMjEgMjEgMTYuNTIyOCAyMSAxMUMyMSA1LjQ3NzE1IDE2LjUyMjggMSAxMSAxQzUuNDc3MTUgMSAxIDUuNDc3MTUgMSAxMUMxIDE2LjUyMjggNS40NzcxNSAyMSAxMSAyMVoiLz4KICA8cGF0aCBmaWxsPSIjMGY2ZWMxIiBkPSJNMTEgMTlDMTUuNDE4MyAxOSAxOSAxNS40MTgzIDE5IDExQzE5IDYuNTgxNzIgMTUuNDE4MyAzIDExIDNDNi41ODE3MiAzIDMgNi41ODE3MiAzIDExQzMgMTUuNDE4MyA2LjU4MTcyIDE5IDExIDE5WiIvPgo8L3N2Zz4K"},N=14,b="#ffffff";function a(r){switch(r){case"fast":case"normal":case"slow":case"slow-jams":case"no-traffic":return r;default:return"ignore"}}function y(r){return r.map(function(e,n){var t=String(n);return n===0&&(t="A"),n===r.length-1&&(t="B"),{position:e,label:{text:t,fontSize:N,color:b},icon:_}})}var D=p(0),L=function(){function r(e,n){this.defaultStyle={routeLineWidth:10.5,substrateLineWidth:21.5,haloLineWidth:23.1},this.map=e,this.settings=n,this.polylines=[],this.markers=[],this.nextPolylinePhase=g,this.nextPointPhase=f}return r.prototype.draw=function(e){this.drawPoints(e.points),this.drawRoutes(e.routes,e.activeRouteId,e.style)},r.prototype.clear=function(){this.draw({routes:[],points:[]})},r.prototype.drawPoints=function(e){for(var n=0,t=this.markers;n<t.length;n++)(h=t[n]).destroy();this.markers=[],this.nextPointPhase=f;for(var o=0;o<e.length;o++){var u=e[o],m=u.position,I=u.label,c=u.icon,h=new mapgl.Marker(this.map,{coordinates:m,icon:c.img,size:c.size,anchor:c.offset,zIndex:this.getNextPointPhase(),label:{text:I.text,fontSize:I.fontSize,color:I.color,anchor:[0,0],zIndex:this.getNextPointPhase(),haloRadius:0,haloColor:"#ffffff",letterSpacing:0,lineHeight:1.2,minZoom:NaN,maxZoom:NaN}});this.markers.push(h)}},r.prototype.drawRoutes=function(e,n,t){for(var o=0,u=this.polylines;o<u.length;o++)u[o].polyline.destroy();this.polylines=[],this.nextPolylinePhase=g;for(var m,I=l(l({},this.defaultStyle),t),c=0,h=e;c<h.length;c++){var w=h[c];w.id===n?m=w:this.drawRoute(w,!1,I)}m&&this.drawRoute(m,!0,I)},r.prototype.drawRoute=function(e,n,t){for(var o=e.id,u=e.sections,m=this.getNextPolylinePhase(),I=this.getNextPolylinePhase(),c=0,h=u;c<h.length;c++){var w=h[c],j=Object(D.parse)(w.geometry);if(j){var O=j.coordinates,S=this.settings.lineStyles,Z=S[w.type]!==void 0?w.type:"inactive",U=n?Z:"inactive",z=S[U],G=z.color,W=z.borderColor,k=z.border2Color,B=new mapgl.Polyline(this.map,{coordinates:O,zIndex:this.getNextPolylinePhase(),zIndex2:I,zIndex3:m,color:G,color2:W,color3:k,width:t.routeLineWidth,width2:t.substrateLineWidth,width3:t.haloLineWidth,interactive:!0,maxZoom:NaN,minZoom:NaN});this.polylines.push({routeId:o,type:U,polyline:B})}}},r.prototype.getNextPolylinePhase=function(){return this.nextPolylinePhase+=1e-6},r.prototype.getNextPointPhase=function(){return this.nextPointPhase+=1e-6},r}(),M=function(r,e){return{color:e[r],hoveredColor:e.hovered,borderColor:e.border,hoveredBorderColor:e.border,border2Color:e.border2,hoveredBorder2Color:e.border2}},i=function(r){function e(n,t){var o=r.call(this)||this;o.map=n,o.options=t;var u,m={lineStyles:{normal:M("normal",u=P),fast:M("fast",u),ignore:M("ignore",u),"no-traffic":M("no-traffic",u),slow:M("slow",u),"slow-jams":M("slow-jams",u),pedestrian:M("pedestrian",u),"pedestrian-underground":M("pedestrian-underground",u),inactive:M("inactive",u)}};return o.ppnaDrawer=new L(o.map,m),o}return function(n,t){function o(){this.constructor=n}s(n,t),n.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}(e,r),e.prototype.clear=function(){this.ppnaDrawer.clear(),this.map.setStyleOptions({traffic:!1})},e.prototype.carRoute=function(n){var t=n.points,o=n.style;return this.findAndDrawRoute({type:"jam",points:t,style:o})},e.prototype.pedestrianRoute=function(n){var t=n.points,o=n.style;return this.findAndDrawRoute({type:"pedestrian",points:t,style:o})},e.prototype.findAndDrawRoute=function(n){var t=this,o=n.points,u=n.type,m=n.style;if(o.length<2)throw new Error("At least two points are required");var I={type:u,point_a_name:"Source",point_b_name:"Target",locale:"en",points:o.map(function(c,h){return{x:c[0],y:c[1],type:h===0||h===o.length-1?"pedo":"pref"}})};return fetch("https://catalog.api.2gis.ru/carrouting/6.0.0/global?key="+this.options.directionsApiKey,{method:"post",body:JSON.stringify(I)}).then(function(c){if(c.status!==200)throw new Error("HTTP code is "+c.status);return c.json()}).then(function(c){t.emit("directionsLoaded",{routes:c.result||[]}),t.drawRoute(c.result||[],n.points,m)})},e.prototype.drawRoute=function(n,t,o){var u=function(m,I){var c=[];return I.forEach(function(h){var w={id:h.id,sections:[]};h.begin_pedestrian_path&&w.sections.push({type:"pedestrian",geometry:h.begin_pedestrian_path.geometry.selection}),(h.maneuvers||[]).forEach(function(j){var O=j.outcoming_path&&j.outcoming_path.geometry;O&&O.forEach(function(S){w.sections.push({type:m!=="pedestrian"?a(S.color):"pedestrian",geometry:S.selection})})}),h.end_pedestrian_path&&w.sections.push({type:"pedestrian",geometry:h.end_pedestrian_path.geometry.selection}),c.push(w)}),c}("ppna",n)[0];this.map.setStyleOptions({traffic:!0}),this.ppnaDrawer.draw({routes:[u],points:y(t),activeRouteId:u.id,style:o})},e}(function(){function r(){this.events={}}return r.prototype.on=function(e,n){var t=this.events[e];return t||(t=this.events[e]=[]),t.push(n),this},r.prototype.once=function(e,n){var t=this,o=function(u){t.off(e,o),n.call(t,u)};return this.on(e,o),this},r.prototype.off=function(e,n){var t=this.events[e];if(!t)return this;var o=t.indexOf(n);return o!==-1&&t.splice(o,1),this},r.prototype.emit=function(e,n){var t=this.events[e];if(!t)return this;for(var o=t.slice(),u=0;u<o.length;u++)o[u].call(this,n);return this},r}());typeof window<"u"&&("mapgl"in window?mapgl.Directions=i:(window.__mapglPlugins||(window.__mapglPlugins={}),window.__mapglPlugins.Directions=i))}])})})(R);var ft=R.exports;export{ct as L,ft as d,it as l};
