import{_ as q,a3 as k,Y as d,l as I,P as O,M as R,D as L,Q as V,T as X,j as h}from"./index-47b4a022.js";import{l as G,d as Q,L as N}from"./directions-2b84729d.js";import{a as f}from"./user-7a776cf7.js";import{u as W}from"./order-65aed67f.js";import{u as _,V as F}from"./userPanel-b5620d02.js";import{u as Y}from"./directions-c57ca3d8.js";import"./_commonjsHelpers-725317a4.js";import"./useRender-5142e326.js";const J="data:image/png;base64,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";const $={class:"map",id:"map"},tt={class:"marker"},et="896f3963-4c91-4ce7-9a61-6f91f3ff7ebd",y="rukuvo0173",w="896f3963-4c91-4ce7-9a61-6f91f3ff7ebd",ot=`
                <div class="buttonRoot" id="find-me">
                    <button class="button">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="32"
                            height="32"
                            viewBox="0 0 32 32"
                        >
                            <path
                                fill="black"
                                d="M17.89 26.27l-2.7-9.46-9.46-2.7 18.92-6.76zm-5.62-12.38l4.54 1.3 1.3 4.54 3.24-9.08z"
                            />
                        </svg>
                    </button>
                </div>
                <style>
                svg{
                    background-color: white;
                    border-radius: 5px
                }
                </style>
            `,nt={__name:"Map",setup(it){const a=Y(),c=W(),P=_(),{drawDirection:S,clearDirection:E,positionMap:b}=k(a),{rerenderMap:K,centerMap:v}=k(c);let l,m={name:"",coordinates:[0,0],building_id:""},p=!0;function D(o){f.get("https://catalog.api.2gis.com/3.0/items/geocode?lat="+o[1]+"&lon="+o[0]+"&fields=items.adm_div,items.address&&radius=50&key="+y).then(s=>{var i;window.localStorage.setItem("city",(i=s.data)==null?void 0:i.result.items[0].adm_div[1].name)})}function M(o,s){f.post("https://routing.api.2gis.com/carrouting/6.0.0/global?key="+w,{type:"jam",points:[{type:"walking",x:o[0],y:o[1]},{type:"walking",x:s[0],y:s[1]}]}).then(i=>{var r,t;a.timeEstimate=(((r=i.data)==null?void 0:r.result[0].total_duration)/60).toFixed(0),a.timeEstimate===0&&(a.timeEstimate=1),a.distanceEstimate=(((t=i.data)==null?void 0:t.result[0].total_distance)/1e3).toFixed(0)})}function B(o){f.get("https://catalog.api.2gis.com/3.0/items/geocode?lat="+o[1]+"&lon="+o[0]+"&fields=items.adm_div,items.address&&radius=50&key="+y).then(s=>{var i;for(const r of(i=s.data)==null?void 0:i.result.items)if(console.log(r),r.address_name!=null){m.name=r.name,m.coordinates=o,m.building_id=r.id;break}c.point={...m}})}return G().then(o=>{function s(){navigator.geolocation.getCurrentPosition(U,A)}let i,r;d(v,()=>{}),r=15,i=[76.9351982,43.2516761];const t=new o.Map("map",{center:i,zoom:r,key:et,zoomControl:!1}),u=new Q.Directions(t,{directionsApiKey:w});d(S,()=>{C(a.pointA.coordinates,a.pointB.coordinates)}),d(E,()=>{x()}),d(b,()=>{console.log("map position"),t.setCenter(a.pointA.coordinates),t.setZoom(18)});function C(e,n,H){u.carRoute({points:[e,n]}),H&&(t.setCenter(e),t.setZoom(13.5)),M(e,n)}function x(){u.clear()}d(K,()=>{T()});async function T(){await g(50),t.invalidateSize()}t.on("moveend",z),new o.Control(t,ot,{position:"centerRight"}).getContainer().querySelector("#find-me").addEventListener("click",Z);function Z(){navigator.geolocation.getCurrentPosition(j,A)}function g(e){return new Promise(n=>setTimeout(n,e))}async function z(){if(!(Object.keys(c.pointA).length&&Object.keys(c.pointB).length)){await g(250);let e=t.getCenter();await g(650);let n=t.getCenter();console.log(e,n),e[0]===n[0]&&e[1]===n[1]&&(console.log("ok"),B(e),p&&(D(e),p=!1))}}s();function U(e){let n=[e.coords.longitude,e.coords.latitude];l&&l.destroy(),l=new o.CircleMarker(t,{coordinates:n,radius:14,color:"#0088ff",strokeWidth:4,strokeColor:"#ffffff",stroke2Width:6,stroke2Color:"#0088ff55"}),!c.centerMap&&!c.drawDirection&&(t.setCenter(n),t.setZoom(16))}function j(e){let n=[e.coords.longitude,e.coords.latitude];l&&l.destroy(),l=new o.CircleMarker(t,{coordinates:n,radius:14,color:"#0088ff",strokeWidth:4,strokeColor:"#ffffff",stroke2Width:6,stroke2Color:"#0088ff55"}),t.setCenter(n),t.setZoom(16)}function A(){console.log("error")}}),(o,s)=>(I(),O("div",$,[R("div",tt,[L(h(F,{src:J,id:"marker-icon"},null,512),[[V,X(P).mode==="stand-by"]])]),h(N)]))}},pt=q(nt,[["__scopeId","data-v-e1b36ed9"]]);export{pt as default};
